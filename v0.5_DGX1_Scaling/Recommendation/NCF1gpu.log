Clearing caches

:::MLPv0.5.0 ncf 1560195898.070008993 (<string>:1) run_clear_caches
Launching on node dgx1
+ pids+=($!)
+ set +x
++ eval echo
+++ echo
+ docker exec -e DGXSYSTEM=DGX1 -e 'SEED=     6922852' -e MULTI_NODE= -e SLURM_JOB_ID=190610141231 -e SLURM_NTASKS_PER_NODE= cont_190610141231 ./run_and_time.sh
Run vars: id 190610141231 gpus 8 mparams 
DGX1
+ echo 'running benchmark'
+ DATASET_DIR=/data/ml-20m
+ SEED='     6922852'
+ numactl --show
STARTING TIMING RUN AT 2019-06-10 07:44:58 PM
running benchmark
+ python -m torch.distributed.launch --nproc_per_node 1 ncf.py /data/ml-20m -l 0.0045 -b 1048576 -b1 0.25 -b2 0.5 --eps 1e-8 --valid-batch-size 1048576 --loss-scale 8192 --layers 256 256 128 64 -f 64 --seed 6922852 --threshold 0.635 --fp16
------------------------------------------------------------ARGS-LOCAL-RANK----------- 0
Using seed = 6922852
Saving config and results to ./run/neumf/1560195899.0

:::MLPv0.5.0 ncf 1560195899.420783043 (ncf.py:230) preproc_hp_num_eval: 999

:::MLPv0.5.0 ncf 1560195899.421389818 (ncf.py:232) preproc_hp_sample_eval_replacement: true

:::MLPv0.5.0 ncf 1560195899.421949625 (ncf.py:233) input_hp_sample_train_replacement

:::MLPv0.5.0 ncf 1560195899.422589540 (ncf.py:234) input_step_eval_neg_gen

:::MLPv0.5.0 ncf 1560195900.473513126 (ncf.py:244) run_start

:::MLPv0.5.0 ncf 1560195903.776392937 (ncf.py:259) input_size: 19861770

:::MLPv0.5.0 ncf 1560195904.362980127 (ncf.py:314) input_batch_size: 1048576

:::MLPv0.5.0 ncf 1560195904.363599062 (ncf.py:315) input_order
Load data done [3.9 s]. #user=138493, #item=26744, #train=19861770, #test=138493

:::MLPv0.5.0 ncf 1560195904.364802122 (/workspace/recommendation/neumf.py:49) model_hp_mf_dim

:::MLPv0.5.0 ncf 1560195905.122659683 (/workspace/recommendation/neumf.py:57) model_hp_mlp_layer_sizes: [256, 256, 128, 64]
NeuMF(
  (mf_user_embed): Embedding(138493, 64)
  (mf_item_embed): Embedding(26744, 64)
  (mlp_user_embed): Embedding(138493, 128)
  (mlp_item_embed): Embedding(26744, 128)
  (mlp): ModuleList(
    (0): Linear(in_features=256, out_features=256, bias=True)
    (1): Linear(in_features=256, out_features=128, bias=True)
    (2): Linear(in_features=128, out_features=64, bias=True)
  )
  (final): Linear(in_features=128, out_features=1, bias=True)
)
31832577 parameters
Initializing fp16 optimizer
Reset fp16 grad
Initializing fp32 clone weights

:::MLPv0.5.0 ncf 1560195906.024082422 (ncf.py:348) opt_learning_rate: 0.0045

:::MLPv0.5.0 ncf 1560195906.024824142 (ncf.py:349) opt_name: "Adam"

:::MLPv0.5.0 ncf 1560195906.025457382 (ncf.py:350) opt_hp_Adam_beta1: 0.25

:::MLPv0.5.0 ncf 1560195906.026092291 (ncf.py:351) opt_hp_Adam_beta2: 0.5

:::MLPv0.5.0 ncf 1560195906.026732206 (ncf.py:352) opt_hp_Adam_epsilon: 1e-08

:::MLPv0.5.0 ncf 1560195906.027387381 (ncf.py:353) model_hp_loss_fn: "binary_cross_entropy"

:::MLPv0.5.0 ncf 1560195908.961622953 (ncf.py:152) eval_size: {"epoch": null, "value": 138493000}

:::MLPv0.5.0 ncf 1560195908.962141275 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560195908.962491035 (ncf.py:154) eval_hp_num_neg: 999
Initial HR@10 = 0.0057, NDCG@10 = 0.0033

:::MLPv0.5.0 ncf 1560195908.962933064 (ncf.py:378) train_loop

:::MLPv0.5.0 ncf 1560195908.963254452 (ncf.py:381) train_epoch: 0

:::MLPv0.5.0 ncf 1560195908.963564396 (ncf.py:382) input_hp_num_neg: 4

:::MLPv0.5.0 ncf 1560195908.963863611 (ncf.py:383) input_step_train_neg_gen
  0%|          | 0/95 [00:00<?, ?it/s]  1%|          | 1/95 [00:00<00:32,  2.89it/s]  4%|▍         | 4/95 [00:00<00:11,  8.26it/s]  7%|▋         | 7/95 [00:00<00:07, 11.23it/s] 11%|█         | 10/95 [00:00<00:06, 13.12it/s] 14%|█▎        | 13/95 [00:00<00:05, 14.42it/s] 17%|█▋        | 16/95 [00:01<00:05, 15.37it/s] 20%|██        | 19/95 [00:01<00:04, 16.10it/s] 23%|██▎       | 22/95 [00:01<00:04, 16.68it/s] 26%|██▋       | 25/95 [00:01<00:04, 17.15it/s] 29%|██▉       | 28/95 [00:01<00:03, 17.53it/s] 33%|███▎      | 31/95 [00:01<00:03, 17.86it/s] 36%|███▌      | 34/95 [00:01<00:03, 18.14it/s] 39%|███▉      | 37/95 [00:02<00:03, 18.37it/s] 42%|████▏     | 40/95 [00:02<00:02, 18.58it/s] 45%|████▌     | 43/95 [00:02<00:02, 18.76it/s] 48%|████▊     | 46/95 [00:02<00:02, 18.91it/s] 52%|█████▏    | 49/95 [00:02<00:02, 19.04it/s] 55%|█████▍    | 52/95 [00:02<00:02, 19.17it/s] 58%|█████▊    | 55/95 [00:02<00:02, 19.28it/s] 61%|██████    | 58/95 [00:02<00:01, 19.39it/s] 64%|██████▍   | 61/95 [00:03<00:01, 19.49it/s] 67%|██████▋   | 64/95 [00:03<00:01, 19.58it/s] 71%|███████   | 67/95 [00:03<00:01, 19.66it/s] 74%|███████▎  | 70/95 [00:03<00:01, 19.73it/s] 77%|███████▋  | 73/95 [00:03<00:01, 19.80it/s] 80%|████████  | 76/95 [00:03<00:00, 19.87it/s] 83%|████████▎ | 79/95 [00:03<00:00, 19.93it/s] 86%|████████▋ | 82/95 [00:04<00:00, 19.99it/s] 89%|████████▉ | 85/95 [00:04<00:00, 20.04it/s] 93%|█████████▎| 88/95 [00:04<00:00, 20.09it/s] 96%|█████████▌| 91/95 [00:04<00:00, 20.13it/s] 99%|█████████▉| 94/95 [00:04<00:00, 20.18it/s]100%|██████████| 95/95 [00:04<00:00, 20.20it/s]

:::MLPv0.5.0 ncf 1560195913.898403645 (ncf.py:440) eval_start

:::MLPv0.5.0 ncf 1560195916.322214842 (ncf.py:152) eval_size: {"epoch": 0, "value": 138493000}

:::MLPv0.5.0 ncf 1560195916.322571039 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560195916.322909594 (ncf.py:154) eval_hp_num_neg: 999
Epoch 0: HR@10 = 0.4252, NDCG@10 = 0.2406, train_time = 4.93, val_time = 2.43

:::MLPv0.5.0 ncf 1560195916.324605703 (ncf.py:452) eval_accuracy: {"epoch": 0, "value": 0.4251839443148751}

:::MLPv0.5.0 ncf 1560195916.325233936 (ncf.py:453) eval_target: 0.635

:::MLPv0.5.0 ncf 1560195916.325758219 (ncf.py:454) eval_stop

:::MLPv0.5.0 ncf 1560195916.326308250 (ncf.py:381) train_epoch: 1

:::MLPv0.5.0 ncf 1560195916.326776981 (ncf.py:382) input_hp_num_neg: 4

:::MLPv0.5.0 ncf 1560195916.327241898 (ncf.py:383) input_step_train_neg_gen
  0%|          | 0/95 [00:00<?, ?it/s]  2%|▏         | 2/95 [00:00<00:05, 17.88it/s]  5%|▌         | 5/95 [00:00<00:04, 19.94it/s]  8%|▊         | 8/95 [00:00<00:04, 20.53it/s] 12%|█▏        | 11/95 [00:00<00:04, 20.81it/s] 15%|█▍        | 14/95 [00:00<00:03, 20.97it/s] 18%|█▊        | 17/95 [00:00<00:03, 21.08it/s] 21%|██        | 20/95 [00:00<00:03, 21.16it/s] 24%|██▍       | 23/95 [00:01<00:03, 21.21it/s] 27%|██▋       | 26/95 [00:01<00:03, 21.26it/s] 31%|███       | 29/95 [00:01<00:03, 21.29it/s] 34%|███▎      | 32/95 [00:01<00:02, 21.32it/s] 37%|███▋      | 35/95 [00:01<00:02, 21.34it/s] 40%|████      | 38/95 [00:01<00:02, 21.36it/s] 43%|████▎     | 41/95 [00:01<00:02, 21.38it/s] 46%|████▋     | 44/95 [00:02<00:02, 21.40it/s] 49%|████▉     | 47/95 [00:02<00:02, 21.41it/s] 53%|█████▎    | 50/95 [00:02<00:02, 21.42it/s] 56%|█████▌    | 53/95 [00:02<00:01, 21.43it/s] 59%|█████▉    | 56/95 [00:02<00:01, 21.43it/s] 62%|██████▏   | 59/95 [00:02<00:01, 21.44it/s] 65%|██████▌   | 62/95 [00:02<00:01, 21.45it/s] 68%|██████▊   | 65/95 [00:03<00:01, 21.46it/s] 72%|███████▏  | 68/95 [00:03<00:01, 21.46it/s] 75%|███████▍  | 71/95 [00:03<00:01, 21.47it/s] 78%|███████▊  | 74/95 [00:03<00:00, 21.47it/s] 81%|████████  | 77/95 [00:03<00:00, 21.48it/s] 84%|████████▍ | 80/95 [00:03<00:00, 21.48it/s] 87%|████████▋ | 83/95 [00:03<00:00, 21.49it/s] 91%|█████████ | 86/95 [00:04<00:00, 21.49it/s] 94%|█████████▎| 89/95 [00:04<00:00, 21.50it/s] 97%|█████████▋| 92/95 [00:04<00:00, 21.50it/s]100%|██████████| 95/95 [00:04<00:00, 21.51it/s]

:::MLPv0.5.0 ncf 1560195920.974267960 (ncf.py:440) eval_start

:::MLPv0.5.0 ncf 1560195923.397474289 (ncf.py:152) eval_size: {"epoch": 1, "value": 138493000}

:::MLPv0.5.0 ncf 1560195923.398024797 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560195923.398382902 (ncf.py:154) eval_hp_num_neg: 999
Epoch 1: HR@10 = 0.4793, NDCG@10 = 0.2729, train_time = 4.65, val_time = 2.43

:::MLPv0.5.0 ncf 1560195923.399007559 (ncf.py:452) eval_accuracy: {"epoch": 1, "value": 0.47929498241788393}

:::MLPv0.5.0 ncf 1560195923.399327755 (ncf.py:453) eval_target: 0.635

:::MLPv0.5.0 ncf 1560195923.399621010 (ncf.py:454) eval_stop

:::MLPv0.5.0 ncf 1560195923.399936199 (ncf.py:381) train_epoch: 2

:::MLPv0.5.0 ncf 1560195923.400249481 (ncf.py:382) input_hp_num_neg: 4

:::MLPv0.5.0 ncf 1560195923.400553226 (ncf.py:383) input_step_train_neg_gen
  0%|          | 0/95 [00:00<?, ?it/s]  2%|▏         | 2/95 [00:00<00:05, 17.87it/s]  5%|▌         | 5/95 [00:00<00:04, 19.94it/s]  8%|▊         | 8/95 [00:00<00:04, 20.52it/s] 12%|█▏        | 11/95 [00:00<00:04, 20.80it/s] 15%|█▍        | 14/95 [00:00<00:03, 20.96it/s] 18%|█▊        | 17/95 [00:00<00:03, 21.06it/s] 21%|██        | 20/95 [00:00<00:03, 21.14it/s] 24%|██▍       | 23/95 [00:01<00:03, 21.19it/s] 27%|██▋       | 26/95 [00:01<00:03, 21.24it/s] 31%|███       | 29/95 [00:01<00:03, 21.28it/s] 34%|███▎      | 32/95 [00:01<00:02, 21.30it/s] 37%|███▋      | 35/95 [00:01<00:02, 21.33it/s] 40%|████      | 38/95 [00:01<00:02, 21.35it/s] 43%|████▎     | 41/95 [00:01<00:02, 21.37it/s] 46%|████▋     | 44/95 [00:02<00:02, 21.38it/s] 49%|████▉     | 47/95 [00:02<00:02, 21.40it/s] 53%|█████▎    | 50/95 [00:02<00:02, 21.41it/s] 56%|█████▌    | 53/95 [00:02<00:01, 21.42it/s] 59%|█████▉    | 56/95 [00:02<00:01, 21.43it/s] 62%|██████▏   | 59/95 [00:02<00:01, 21.44it/s] 65%|██████▌   | 62/95 [00:02<00:01, 21.44it/s] 68%|██████▊   | 65/95 [00:03<00:01, 21.45it/s] 72%|███████▏  | 68/95 [00:03<00:01, 21.46it/s] 75%|███████▍  | 71/95 [00:03<00:01, 21.46it/s] 78%|███████▊  | 74/95 [00:03<00:00, 21.47it/s] 81%|████████  | 77/95 [00:03<00:00, 21.47it/s] 84%|████████▍ | 80/95 [00:03<00:00, 21.47it/s] 87%|████████▋ | 83/95 [00:03<00:00, 21.48it/s] 91%|█████████ | 86/95 [00:04<00:00, 21.48it/s] 94%|█████████▎| 89/95 [00:04<00:00, 21.49it/s] 97%|█████████▋| 92/95 [00:04<00:00, 21.49it/s]100%|██████████| 95/95 [00:04<00:00, 21.50it/s]

:::MLPv0.5.0 ncf 1560195928.045141459 (ncf.py:440) eval_start

:::MLPv0.5.0 ncf 1560195930.468401670 (ncf.py:152) eval_size: {"epoch": 2, "value": 138493000}

:::MLPv0.5.0 ncf 1560195930.468982220 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560195930.469331026 (ncf.py:154) eval_hp_num_neg: 999
Epoch 2: HR@10 = 0.5194, NDCG@10 = 0.2972, train_time = 4.64, val_time = 2.43

:::MLPv0.5.0 ncf 1560195930.470030069 (ncf.py:452) eval_accuracy: {"epoch": 2, "value": 0.5193619894146274}

:::MLPv0.5.0 ncf 1560195930.470347166 (ncf.py:453) eval_target: 0.635

:::MLPv0.5.0 ncf 1560195930.470643759 (ncf.py:454) eval_stop

:::MLPv0.5.0 ncf 1560195930.470967531 (ncf.py:381) train_epoch: 3

:::MLPv0.5.0 ncf 1560195930.471268415 (ncf.py:382) input_hp_num_neg: 4

:::MLPv0.5.0 ncf 1560195930.471563339 (ncf.py:383) input_step_train_neg_gen
  0%|          | 0/95 [00:00<?, ?it/s]  2%|▏         | 2/95 [00:00<00:05, 17.86it/s]  5%|▌         | 5/95 [00:00<00:04, 19.94it/s]  8%|▊         | 8/95 [00:00<00:04, 20.52it/s] 12%|█▏        | 11/95 [00:00<00:04, 20.81it/s] 15%|█▍        | 14/95 [00:00<00:03, 20.97it/s] 18%|█▊        | 17/95 [00:00<00:03, 21.08it/s] 21%|██        | 20/95 [00:00<00:03, 21.16it/s] 24%|██▍       | 23/95 [00:01<00:03, 21.21it/s] 27%|██▋       | 26/95 [00:01<00:03, 21.25it/s] 31%|███       | 29/95 [00:01<00:03, 21.29it/s] 34%|███▎      | 32/95 [00:01<00:02, 21.31it/s] 37%|███▋      | 35/95 [00:01<00:02, 21.34it/s] 40%|████      | 38/95 [00:01<00:02, 21.36it/s] 43%|████▎     | 41/95 [00:01<00:02, 21.38it/s] 46%|████▋     | 44/95 [00:02<00:02, 21.39it/s] 49%|████▉     | 47/95 [00:02<00:02, 21.41it/s] 53%|█████▎    | 50/95 [00:02<00:02, 21.42it/s] 56%|█████▌    | 53/95 [00:02<00:01, 21.43it/s] 59%|█████▉    | 56/95 [00:02<00:01, 21.44it/s] 62%|██████▏   | 59/95 [00:02<00:01, 21.44it/s] 65%|██████▌   | 62/95 [00:02<00:01, 21.45it/s] 68%|██████▊   | 65/95 [00:03<00:01, 21.45it/s] 72%|███████▏  | 68/95 [00:03<00:01, 21.46it/s] 75%|███████▍  | 71/95 [00:03<00:01, 21.46it/s] 78%|███████▊  | 74/95 [00:03<00:00, 21.47it/s] 81%|████████  | 77/95 [00:03<00:00, 21.47it/s] 84%|████████▍ | 80/95 [00:03<00:00, 21.48it/s] 87%|████████▋ | 83/95 [00:03<00:00, 21.48it/s] 91%|█████████ | 86/95 [00:04<00:00, 21.49it/s] 94%|█████████▎| 89/95 [00:04<00:00, 21.49it/s] 97%|█████████▋| 92/95 [00:04<00:00, 21.50it/s]100%|██████████| 95/95 [00:04<00:00, 21.50it/s]

:::MLPv0.5.0 ncf 1560195935.116052628 (ncf.py:440) eval_start

:::MLPv0.5.0 ncf 1560195937.537586689 (ncf.py:152) eval_size: {"epoch": 3, "value": 138493000}

:::MLPv0.5.0 ncf 1560195937.537945032 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560195937.538284063 (ncf.py:154) eval_hp_num_neg: 999
Epoch 3: HR@10 = 0.5609, NDCG@10 = 0.3265, train_time = 4.64, val_time = 2.42

:::MLPv0.5.0 ncf 1560195937.538877964 (ncf.py:452) eval_accuracy: {"epoch": 3, "value": 0.5608947744651355}

:::MLPv0.5.0 ncf 1560195937.539191723 (ncf.py:453) eval_target: 0.635

:::MLPv0.5.0 ncf 1560195937.539487600 (ncf.py:454) eval_stop

:::MLPv0.5.0 ncf 1560195937.539814949 (ncf.py:381) train_epoch: 4

:::MLPv0.5.0 ncf 1560195937.540116072 (ncf.py:382) input_hp_num_neg: 4

:::MLPv0.5.0 ncf 1560195937.540405273 (ncf.py:383) input_step_train_neg_gen
  0%|          | 0/95 [00:00<?, ?it/s]  2%|▏         | 2/95 [00:00<00:05, 17.86it/s]  5%|▌         | 5/95 [00:00<00:04, 19.93it/s]  8%|▊         | 8/95 [00:00<00:04, 20.53it/s] 12%|█▏        | 11/95 [00:00<00:04, 20.81it/s] 15%|█▍        | 14/95 [00:00<00:03, 20.98it/s] 18%|█▊        | 17/95 [00:00<00:03, 21.08it/s] 21%|██        | 20/95 [00:00<00:03, 21.16it/s] 24%|██▍       | 23/95 [00:01<00:03, 21.21it/s] 27%|██▋       | 26/95 [00:01<00:03, 21.26it/s] 31%|███       | 29/95 [00:01<00:03, 21.29it/s] 34%|███▎      | 32/95 [00:01<00:02, 21.32it/s] 37%|███▋      | 35/95 [00:01<00:02, 21.34it/s] 40%|████      | 38/95 [00:01<00:02, 21.36it/s] 43%|████▎     | 41/95 [00:01<00:02, 21.38it/s] 46%|████▋     | 44/95 [00:02<00:02, 21.39it/s] 49%|████▉     | 47/95 [00:02<00:02, 21.40it/s] 53%|█████▎    | 50/95 [00:02<00:02, 21.42it/s] 56%|█████▌    | 53/95 [00:02<00:01, 21.43it/s] 59%|█████▉    | 56/95 [00:02<00:01, 21.43it/s] 62%|██████▏   | 59/95 [00:02<00:01, 21.44it/s] 65%|██████▌   | 62/95 [00:02<00:01, 21.45it/s] 68%|██████▊   | 65/95 [00:03<00:01, 21.46it/s] 72%|███████▏  | 68/95 [00:03<00:01, 21.46it/s] 75%|███████▍  | 71/95 [00:03<00:01, 21.47it/s] 78%|███████▊  | 74/95 [00:03<00:00, 21.47it/s] 81%|████████  | 77/95 [00:03<00:00, 21.48it/s] 84%|████████▍ | 80/95 [00:03<00:00, 21.48it/s] 87%|████████▋ | 83/95 [00:03<00:00, 21.49it/s] 91%|█████████ | 86/95 [00:04<00:00, 21.49it/s] 94%|█████████▎| 89/95 [00:04<00:00, 21.49it/s] 97%|█████████▋| 92/95 [00:04<00:00, 21.50it/s]100%|██████████| 95/95 [00:04<00:00, 21.51it/s]

:::MLPv0.5.0 ncf 1560195942.184384346 (ncf.py:440) eval_start

:::MLPv0.5.0 ncf 1560195944.607032299 (ncf.py:152) eval_size: {"epoch": 4, "value": 138493000}

:::MLPv0.5.0 ncf 1560195944.607566833 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560195944.607909441 (ncf.py:154) eval_hp_num_neg: 999
Epoch 4: HR@10 = 0.5900, NDCG@10 = 0.3473, train_time = 4.64, val_time = 2.42

:::MLPv0.5.0 ncf 1560195944.608551502 (ncf.py:452) eval_accuracy: {"epoch": 4, "value": 0.5900370415833291}

:::MLPv0.5.0 ncf 1560195944.608875990 (ncf.py:453) eval_target: 0.635

:::MLPv0.5.0 ncf 1560195944.609173059 (ncf.py:454) eval_stop

:::MLPv0.5.0 ncf 1560195944.609503269 (ncf.py:381) train_epoch: 5

:::MLPv0.5.0 ncf 1560195944.609816074 (ncf.py:382) input_hp_num_neg: 4

:::MLPv0.5.0 ncf 1560195944.610106468 (ncf.py:383) input_step_train_neg_gen
  0%|          | 0/95 [00:00<?, ?it/s]  2%|▏         | 2/95 [00:00<00:05, 17.89it/s]  5%|▌         | 5/95 [00:00<00:04, 19.93it/s]  8%|▊         | 8/95 [00:00<00:04, 20.52it/s] 12%|█▏        | 11/95 [00:00<00:04, 20.81it/s] 15%|█▍        | 14/95 [00:00<00:03, 20.98it/s] 18%|█▊        | 17/95 [00:00<00:03, 21.09it/s] 21%|██        | 20/95 [00:00<00:03, 21.16it/s] 24%|██▍       | 23/95 [00:01<00:03, 21.22it/s] 27%|██▋       | 26/95 [00:01<00:03, 21.26it/s] 31%|███       | 29/95 [00:01<00:03, 21.29it/s] 34%|███▎      | 32/95 [00:01<00:02, 21.32it/s] 37%|███▋      | 35/95 [00:01<00:02, 21.34it/s] 40%|████      | 38/95 [00:01<00:02, 21.36it/s] 43%|████▎     | 41/95 [00:01<00:02, 21.38it/s] 46%|████▋     | 44/95 [00:02<00:02, 21.39it/s] 49%|████▉     | 47/95 [00:02<00:02, 21.40it/s] 53%|█████▎    | 50/95 [00:02<00:02, 21.42it/s] 56%|█████▌    | 53/95 [00:02<00:01, 21.43it/s] 59%|█████▉    | 56/95 [00:02<00:01, 21.44it/s] 62%|██████▏   | 59/95 [00:02<00:01, 21.44it/s] 65%|██████▌   | 62/95 [00:02<00:01, 21.45it/s] 68%|██████▊   | 65/95 [00:03<00:01, 21.46it/s] 72%|███████▏  | 68/95 [00:03<00:01, 21.47it/s] 75%|███████▍  | 71/95 [00:03<00:01, 21.47it/s] 78%|███████▊  | 74/95 [00:03<00:00, 21.48it/s] 81%|████████  | 77/95 [00:03<00:00, 21.48it/s] 84%|████████▍ | 80/95 [00:03<00:00, 21.49it/s] 87%|████████▋ | 83/95 [00:03<00:00, 21.49it/s] 91%|█████████ | 86/95 [00:04<00:00, 21.49it/s] 94%|█████████▎| 89/95 [00:04<00:00, 21.50it/s] 97%|█████████▋| 92/95 [00:04<00:00, 21.50it/s]100%|██████████| 95/95 [00:04<00:00, 21.51it/s]

:::MLPv0.5.0 ncf 1560195949.253448963 (ncf.py:440) eval_start

:::MLPv0.5.0 ncf 1560195951.675842762 (ncf.py:152) eval_size: {"epoch": 5, "value": 138493000}

:::MLPv0.5.0 ncf 1560195951.676380634 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560195951.676733732 (ncf.py:154) eval_hp_num_neg: 999
Epoch 5: HR@10 = 0.5880, NDCG@10 = 0.3452, train_time = 4.64, val_time = 2.42

:::MLPv0.5.0 ncf 1560195951.677350998 (ncf.py:452) eval_accuracy: {"epoch": 5, "value": 0.5879502935166399}

:::MLPv0.5.0 ncf 1560195951.677679539 (ncf.py:453) eval_target: 0.635

:::MLPv0.5.0 ncf 1560195951.677977324 (ncf.py:454) eval_stop

:::MLPv0.5.0 ncf 1560195951.678289652 (ncf.py:381) train_epoch: 6

:::MLPv0.5.0 ncf 1560195951.678587675 (ncf.py:382) input_hp_num_neg: 4

:::MLPv0.5.0 ncf 1560195951.678873539 (ncf.py:383) input_step_train_neg_gen
  0%|          | 0/95 [00:00<?, ?it/s]  2%|▏         | 2/95 [00:00<00:05, 17.84it/s]  5%|▌         | 5/95 [00:00<00:04, 19.92it/s]  8%|▊         | 8/95 [00:00<00:04, 20.52it/s] 12%|█▏        | 11/95 [00:00<00:04, 20.79it/s] 15%|█▍        | 14/95 [00:00<00:03, 20.95it/s] 18%|█▊        | 17/95 [00:00<00:03, 21.06it/s] 21%|██        | 20/95 [00:00<00:03, 21.13it/s] 24%|██▍       | 23/95 [00:01<00:03, 21.20it/s] 27%|██▋       | 26/95 [00:01<00:03, 21.24it/s] 31%|███       | 29/95 [00:01<00:03, 21.28it/s] 34%|███▎      | 32/95 [00:01<00:02, 21.31it/s] 37%|███▋      | 35/95 [00:01<00:02, 21.33it/s] 40%|████      | 38/95 [00:01<00:02, 21.35it/s] 43%|████▎     | 41/95 [00:01<00:02, 21.37it/s] 46%|████▋     | 44/95 [00:02<00:02, 21.38it/s] 49%|████▉     | 47/95 [00:02<00:02, 21.40it/s] 53%|█████▎    | 50/95 [00:02<00:02, 21.41it/s] 56%|█████▌    | 53/95 [00:02<00:01, 21.42it/s] 59%|█████▉    | 56/95 [00:02<00:01, 21.43it/s] 62%|██████▏   | 59/95 [00:02<00:01, 21.43it/s] 65%|██████▌   | 62/95 [00:02<00:01, 21.44it/s] 68%|██████▊   | 65/95 [00:03<00:01, 21.45it/s] 72%|███████▏  | 68/95 [00:03<00:01, 21.45it/s] 75%|███████▍  | 71/95 [00:03<00:01, 21.46it/s] 78%|███████▊  | 74/95 [00:03<00:00, 21.47it/s] 81%|████████  | 77/95 [00:03<00:00, 21.47it/s] 84%|████████▍ | 80/95 [00:03<00:00, 21.47it/s] 87%|████████▋ | 83/95 [00:03<00:00, 21.48it/s] 91%|█████████ | 86/95 [00:04<00:00, 21.48it/s] 94%|█████████▎| 89/95 [00:04<00:00, 21.49it/s] 97%|█████████▋| 92/95 [00:04<00:00, 21.49it/s]100%|██████████| 95/95 [00:04<00:00, 21.50it/s]

:::MLPv0.5.0 ncf 1560195956.323582649 (ncf.py:440) eval_start

:::MLPv0.5.0 ncf 1560195958.746022224 (ncf.py:152) eval_size: {"epoch": 6, "value": 138493000}

:::MLPv0.5.0 ncf 1560195958.746416807 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560195958.746754408 (ncf.py:154) eval_hp_num_neg: 999
Epoch 6: HR@10 = 0.5953, NDCG@10 = 0.3517, train_time = 4.64, val_time = 2.42

:::MLPv0.5.0 ncf 1560195958.747279406 (ncf.py:452) eval_accuracy: {"epoch": 6, "value": 0.5952647426223708}

:::MLPv0.5.0 ncf 1560195958.747589827 (ncf.py:453) eval_target: 0.635

:::MLPv0.5.0 ncf 1560195958.747890949 (ncf.py:454) eval_stop

:::MLPv0.5.0 ncf 1560195958.748191118 (ncf.py:381) train_epoch: 7

:::MLPv0.5.0 ncf 1560195958.748485565 (ncf.py:382) input_hp_num_neg: 4

:::MLPv0.5.0 ncf 1560195958.748772860 (ncf.py:383) input_step_train_neg_gen
  0%|          | 0/95 [00:00<?, ?it/s]  2%|▏         | 2/95 [00:00<00:05, 17.81it/s]  5%|▌         | 5/95 [00:00<00:04, 19.90it/s]  8%|▊         | 8/95 [00:00<00:04, 20.51it/s] 12%|█▏        | 11/95 [00:00<00:04, 20.80it/s] 15%|█▍        | 14/95 [00:00<00:03, 20.97it/s] 18%|█▊        | 17/95 [00:00<00:03, 21.05it/s] 21%|██        | 20/95 [00:00<00:03, 21.13it/s] 24%|██▍       | 23/95 [00:01<00:03, 21.19it/s] 27%|██▋       | 26/95 [00:01<00:03, 21.24it/s] 31%|███       | 29/95 [00:01<00:03, 21.27it/s] 34%|███▎      | 32/95 [00:01<00:02, 21.30it/s] 37%|███▋      | 35/95 [00:01<00:02, 21.33it/s] 40%|████      | 38/95 [00:01<00:02, 21.35it/s] 43%|████▎     | 41/95 [00:01<00:02, 21.36it/s] 46%|████▋     | 44/95 [00:02<00:02, 21.38it/s] 49%|████▉     | 47/95 [00:02<00:02, 21.39it/s] 53%|█████▎    | 50/95 [00:02<00:02, 21.41it/s] 56%|█████▌    | 53/95 [00:02<00:01, 21.42it/s] 59%|█████▉    | 56/95 [00:02<00:01, 21.43it/s] 62%|██████▏   | 59/95 [00:02<00:01, 21.43it/s] 65%|██████▌   | 62/95 [00:02<00:01, 21.44it/s] 68%|██████▊   | 65/95 [00:03<00:01, 21.45it/s] 72%|███████▏  | 68/95 [00:03<00:01, 21.45it/s] 75%|███████▍  | 71/95 [00:03<00:01, 21.46it/s] 78%|███████▊  | 74/95 [00:03<00:00, 21.47it/s] 81%|████████  | 77/95 [00:03<00:00, 21.47it/s] 84%|████████▍ | 80/95 [00:03<00:00, 21.48it/s] 87%|████████▋ | 83/95 [00:03<00:00, 21.48it/s] 91%|█████████ | 86/95 [00:04<00:00, 21.48it/s] 94%|█████████▎| 89/95 [00:04<00:00, 21.49it/s] 97%|█████████▋| 92/95 [00:04<00:00, 21.49it/s]100%|██████████| 95/95 [00:04<00:00, 21.50it/s]

:::MLPv0.5.0 ncf 1560195963.394105673 (ncf.py:440) eval_start

:::MLPv0.5.0 ncf 1560195965.815919876 (ncf.py:152) eval_size: {"epoch": 7, "value": 138493000}

:::MLPv0.5.0 ncf 1560195965.816484928 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560195965.816830158 (ncf.py:154) eval_hp_num_neg: 999
Epoch 7: HR@10 = 0.6023, NDCG@10 = 0.3532, train_time = 4.64, val_time = 2.42

:::MLPv0.5.0 ncf 1560195965.817439318 (ncf.py:452) eval_accuracy: {"epoch": 7, "value": 0.602275927303185}

:::MLPv0.5.0 ncf 1560195965.817770004 (ncf.py:453) eval_target: 0.635

:::MLPv0.5.0 ncf 1560195965.818068504 (ncf.py:454) eval_stop

:::MLPv0.5.0 ncf 1560195965.818377733 (ncf.py:381) train_epoch: 8

:::MLPv0.5.0 ncf 1560195965.818675995 (ncf.py:382) input_hp_num_neg: 4

:::MLPv0.5.0 ncf 1560195965.818963528 (ncf.py:383) input_step_train_neg_gen
  0%|          | 0/95 [00:00<?, ?it/s]  2%|▏         | 2/95 [00:00<00:05, 17.88it/s]  5%|▌         | 5/95 [00:00<00:04, 19.93it/s]  8%|▊         | 8/95 [00:00<00:04, 20.53it/s] 12%|█▏        | 11/95 [00:00<00:04, 20.80it/s] 15%|█▍        | 14/95 [00:00<00:03, 20.96it/s] 18%|█▊        | 17/95 [00:00<00:03, 21.08it/s] 21%|██        | 20/95 [00:00<00:03, 21.16it/s] 24%|██▍       | 23/95 [00:01<00:03, 21.21it/s] 27%|██▋       | 26/95 [00:01<00:03, 21.26it/s] 31%|███       | 29/95 [00:01<00:03, 21.29it/s] 34%|███▎      | 32/95 [00:01<00:02, 21.32it/s] 37%|███▋      | 35/95 [00:01<00:02, 21.34it/s] 40%|████      | 38/95 [00:01<00:02, 21.36it/s] 43%|████▎     | 41/95 [00:01<00:02, 21.38it/s] 46%|████▋     | 44/95 [00:02<00:02, 21.39it/s] 49%|████▉     | 47/95 [00:02<00:02, 21.41it/s] 53%|█████▎    | 50/95 [00:02<00:02, 21.42it/s] 56%|█████▌    | 53/95 [00:02<00:01, 21.43it/s] 59%|█████▉    | 56/95 [00:02<00:01, 21.43it/s] 62%|██████▏   | 59/95 [00:02<00:01, 21.44it/s] 65%|██████▌   | 62/95 [00:02<00:01, 21.45it/s] 68%|██████▊   | 65/95 [00:03<00:01, 21.46it/s] 72%|███████▏  | 68/95 [00:03<00:01, 21.46it/s] 75%|███████▍  | 71/95 [00:03<00:01, 21.47it/s] 78%|███████▊  | 74/95 [00:03<00:00, 21.47it/s] 81%|████████  | 77/95 [00:03<00:00, 21.48it/s] 84%|████████▍ | 80/95 [00:03<00:00, 21.48it/s] 87%|████████▋ | 83/95 [00:03<00:00, 21.49it/s] 91%|█████████ | 86/95 [00:04<00:00, 21.49it/s] 94%|█████████▎| 89/95 [00:04<00:00, 21.49it/s] 97%|█████████▋| 92/95 [00:04<00:00, 21.50it/s]100%|██████████| 95/95 [00:04<00:00, 21.51it/s]

:::MLPv0.5.0 ncf 1560195970.463017941 (ncf.py:440) eval_start

:::MLPv0.5.0 ncf 1560195972.885653257 (ncf.py:152) eval_size: {"epoch": 8, "value": 138493000}

:::MLPv0.5.0 ncf 1560195972.886041880 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560195972.886395693 (ncf.py:154) eval_hp_num_neg: 999
Epoch 8: HR@10 = 0.6178, NDCG@10 = 0.3647, train_time = 4.64, val_time = 2.42

:::MLPv0.5.0 ncf 1560195972.886955023 (ncf.py:452) eval_accuracy: {"epoch": 8, "value": 0.6177640747185779}

:::MLPv0.5.0 ncf 1560195972.887270927 (ncf.py:453) eval_target: 0.635

:::MLPv0.5.0 ncf 1560195972.887572289 (ncf.py:454) eval_stop

:::MLPv0.5.0 ncf 1560195972.887875080 (ncf.py:381) train_epoch: 9

:::MLPv0.5.0 ncf 1560195972.888171434 (ncf.py:382) input_hp_num_neg: 4

:::MLPv0.5.0 ncf 1560195972.888457298 (ncf.py:383) input_step_train_neg_gen
  0%|          | 0/95 [00:00<?, ?it/s]  2%|▏         | 2/95 [00:00<00:05, 17.82it/s]  5%|▌         | 5/95 [00:00<00:04, 19.91it/s]  8%|▊         | 8/95 [00:00<00:04, 20.51it/s] 12%|█▏        | 11/95 [00:00<00:04, 20.80it/s] 15%|█▍        | 14/95 [00:00<00:03, 20.97it/s] 18%|█▊        | 17/95 [00:00<00:03, 21.08it/s] 21%|██        | 20/95 [00:00<00:03, 21.16it/s] 24%|██▍       | 23/95 [00:01<00:03, 21.21it/s] 27%|██▋       | 26/95 [00:01<00:03, 21.26it/s] 31%|███       | 29/95 [00:01<00:03, 21.29it/s] 34%|███▎      | 32/95 [00:01<00:02, 21.32it/s] 37%|███▋      | 35/95 [00:01<00:02, 21.35it/s] 40%|████      | 38/95 [00:01<00:02, 21.37it/s] 43%|████▎     | 41/95 [00:01<00:02, 21.38it/s] 46%|████▋     | 44/95 [00:02<00:02, 21.40it/s] 49%|████▉     | 47/95 [00:02<00:02, 21.41it/s] 53%|█████▎    | 50/95 [00:02<00:02, 21.42it/s] 56%|█████▌    | 53/95 [00:02<00:01, 21.43it/s] 59%|█████▉    | 56/95 [00:02<00:01, 21.44it/s] 62%|██████▏   | 59/95 [00:02<00:01, 21.45it/s] 65%|██████▌   | 62/95 [00:02<00:01, 21.45it/s] 68%|██████▊   | 65/95 [00:03<00:01, 21.46it/s] 72%|███████▏  | 68/95 [00:03<00:01, 21.47it/s] 75%|███████▍  | 71/95 [00:03<00:01, 21.47it/s] 78%|███████▊  | 74/95 [00:03<00:00, 21.48it/s] 81%|████████  | 77/95 [00:03<00:00, 21.48it/s] 84%|████████▍ | 80/95 [00:03<00:00, 21.49it/s] 87%|████████▋ | 83/95 [00:03<00:00, 21.49it/s] 91%|█████████ | 86/95 [00:04<00:00, 21.50it/s] 94%|█████████▎| 89/95 [00:04<00:00, 21.50it/s] 97%|█████████▋| 92/95 [00:04<00:00, 21.50it/s]100%|██████████| 95/95 [00:04<00:00, 21.52it/s]

:::MLPv0.5.0 ncf 1560195977.529320240 (ncf.py:440) eval_start

:::MLPv0.5.0 ncf 1560195979.950765371 (ncf.py:152) eval_size: {"epoch": 9, "value": 138493000}

:::MLPv0.5.0 ncf 1560195979.951196432 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560195979.951536179 (ncf.py:154) eval_hp_num_neg: 999
Epoch 9: HR@10 = 0.6037, NDCG@10 = 0.3562, train_time = 4.64, val_time = 2.42

:::MLPv0.5.0 ncf 1560195979.952097178 (ncf.py:452) eval_accuracy: {"epoch": 9, "value": 0.6036550583784018}

:::MLPv0.5.0 ncf 1560195979.952415466 (ncf.py:453) eval_target: 0.635

:::MLPv0.5.0 ncf 1560195979.952710152 (ncf.py:454) eval_stop

:::MLPv0.5.0 ncf 1560195979.953008413 (ncf.py:381) train_epoch: 10

:::MLPv0.5.0 ncf 1560195979.953320026 (ncf.py:382) input_hp_num_neg: 4

:::MLPv0.5.0 ncf 1560195979.953623056 (ncf.py:383) input_step_train_neg_gen
  0%|          | 0/95 [00:00<?, ?it/s]  2%|▏         | 2/95 [00:00<00:05, 17.92it/s]  5%|▌         | 5/95 [00:00<00:04, 19.95it/s]  8%|▊         | 8/95 [00:00<00:04, 20.52it/s] 12%|█▏        | 11/95 [00:00<00:04, 20.80it/s] 15%|█▍        | 14/95 [00:00<00:03, 20.96it/s] 18%|█▊        | 17/95 [00:00<00:03, 21.07it/s] 21%|██        | 20/95 [00:00<00:03, 21.15it/s] 24%|██▍       | 23/95 [00:01<00:03, 21.21it/s] 27%|██▋       | 26/95 [00:01<00:03, 21.25it/s] 31%|███       | 29/95 [00:01<00:03, 21.29it/s] 34%|███▎      | 32/95 [00:01<00:02, 21.32it/s] 37%|███▋      | 35/95 [00:01<00:02, 21.34it/s] 40%|████      | 38/95 [00:01<00:02, 21.36it/s] 43%|████▎     | 41/95 [00:01<00:02, 21.38it/s] 46%|████▋     | 44/95 [00:02<00:02, 21.40it/s] 49%|████▉     | 47/95 [00:02<00:02, 21.41it/s] 53%|█████▎    | 50/95 [00:02<00:02, 21.42it/s] 56%|█████▌    | 53/95 [00:02<00:01, 21.43it/s] 59%|█████▉    | 56/95 [00:02<00:01, 21.44it/s] 62%|██████▏   | 59/95 [00:02<00:01, 21.45it/s] 65%|██████▌   | 62/95 [00:02<00:01, 21.45it/s] 68%|██████▊   | 65/95 [00:03<00:01, 21.46it/s] 72%|███████▏  | 68/95 [00:03<00:01, 21.47it/s] 75%|███████▍  | 71/95 [00:03<00:01, 21.47it/s] 78%|███████▊  | 74/95 [00:03<00:00, 21.48it/s] 81%|████████  | 77/95 [00:03<00:00, 21.48it/s] 84%|████████▍ | 80/95 [00:03<00:00, 21.48it/s] 87%|████████▋ | 83/95 [00:03<00:00, 21.49it/s] 91%|█████████ | 86/95 [00:04<00:00, 21.49it/s] 94%|█████████▎| 89/95 [00:04<00:00, 21.50it/s] 97%|█████████▋| 92/95 [00:04<00:00, 21.50it/s]100%|██████████| 95/95 [00:04<00:00, 21.51it/s]

:::MLPv0.5.0 ncf 1560195984.596437216 (ncf.py:440) eval_start

:::MLPv0.5.0 ncf 1560195987.018104792 (ncf.py:152) eval_size: {"epoch": 10, "value": 138493000}

:::MLPv0.5.0 ncf 1560195987.018522024 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560195987.018861532 (ncf.py:154) eval_hp_num_neg: 999
Epoch 10: HR@10 = 0.6255, NDCG@10 = 0.3702, train_time = 4.64, val_time = 2.42

:::MLPv0.5.0 ncf 1560195987.019386053 (ncf.py:452) eval_accuracy: {"epoch": 10, "value": 0.6254756558093189}

:::MLPv0.5.0 ncf 1560195987.019701719 (ncf.py:453) eval_target: 0.635

:::MLPv0.5.0 ncf 1560195987.019997120 (ncf.py:454) eval_stop

:::MLPv0.5.0 ncf 1560195987.020340443 (ncf.py:381) train_epoch: 11

:::MLPv0.5.0 ncf 1560195987.020670176 (ncf.py:382) input_hp_num_neg: 4

:::MLPv0.5.0 ncf 1560195987.020958185 (ncf.py:383) input_step_train_neg_gen
  0%|          | 0/95 [00:00<?, ?it/s]  2%|▏         | 2/95 [00:00<00:05, 17.84it/s]  5%|▌         | 5/95 [00:00<00:04, 19.92it/s]  8%|▊         | 8/95 [00:00<00:04, 20.52it/s] 12%|█▏        | 11/95 [00:00<00:04, 20.81it/s] 15%|█▍        | 14/95 [00:00<00:03, 20.97it/s] 18%|█▊        | 17/95 [00:00<00:03, 21.08it/s] 21%|██        | 20/95 [00:00<00:03, 21.15it/s] 24%|██▍       | 23/95 [00:01<00:03, 21.21it/s] 27%|██▋       | 26/95 [00:01<00:03, 21.25it/s] 31%|███       | 29/95 [00:01<00:03, 21.29it/s] 34%|███▎      | 32/95 [00:01<00:02, 21.31it/s] 37%|███▋      | 35/95 [00:01<00:02, 21.34it/s] 40%|████      | 38/95 [00:01<00:02, 21.35it/s] 43%|████▎     | 41/95 [00:01<00:02, 21.37it/s] 46%|████▋     | 44/95 [00:02<00:02, 21.39it/s] 49%|████▉     | 47/95 [00:02<00:02, 21.40it/s] 53%|█████▎    | 50/95 [00:02<00:02, 21.41it/s] 56%|█████▌    | 53/95 [00:02<00:01, 21.42it/s] 59%|█████▉    | 56/95 [00:02<00:01, 21.43it/s] 62%|██████▏   | 59/95 [00:02<00:01, 21.44it/s] 65%|██████▌   | 62/95 [00:02<00:01, 21.45it/s] 68%|██████▊   | 65/95 [00:03<00:01, 21.45it/s] 72%|███████▏  | 68/95 [00:03<00:01, 21.46it/s] 75%|███████▍  | 71/95 [00:03<00:01, 21.47it/s] 78%|███████▊  | 74/95 [00:03<00:00, 21.47it/s] 81%|████████  | 77/95 [00:03<00:00, 21.48it/s] 84%|████████▍ | 80/95 [00:03<00:00, 21.48it/s] 87%|████████▋ | 83/95 [00:03<00:00, 21.48it/s] 91%|█████████ | 86/95 [00:04<00:00, 21.49it/s] 94%|█████████▎| 89/95 [00:04<00:00, 21.49it/s] 97%|█████████▋| 92/95 [00:04<00:00, 21.50it/s]100%|██████████| 95/95 [00:04<00:00, 21.51it/s]

:::MLPv0.5.0 ncf 1560195991.664867640 (ncf.py:440) eval_start

:::MLPv0.5.0 ncf 1560195994.087660551 (ncf.py:152) eval_size: {"epoch": 11, "value": 138493000}

:::MLPv0.5.0 ncf 1560195994.088263512 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560195994.088623762 (ncf.py:154) eval_hp_num_neg: 999
Epoch 11: HR@10 = 0.6309, NDCG@10 = 0.3750, train_time = 4.64, val_time = 2.43

:::MLPv0.5.0 ncf 1560195994.089236736 (ncf.py:452) eval_accuracy: {"epoch": 11, "value": 0.6308549890608189}

:::MLPv0.5.0 ncf 1560195994.089580297 (ncf.py:453) eval_target: 0.635

:::MLPv0.5.0 ncf 1560195994.089890957 (ncf.py:454) eval_stop

:::MLPv0.5.0 ncf 1560195994.090209723 (ncf.py:381) train_epoch: 12

:::MLPv0.5.0 ncf 1560195994.090511084 (ncf.py:382) input_hp_num_neg: 4

:::MLPv0.5.0 ncf 1560195994.090801239 (ncf.py:383) input_step_train_neg_gen
  0%|          | 0/95 [00:00<?, ?it/s]  2%|▏         | 2/95 [00:00<00:05, 17.88it/s]  5%|▌         | 5/95 [00:00<00:04, 19.96it/s]  8%|▊         | 8/95 [00:00<00:04, 20.54it/s] 12%|█▏        | 11/95 [00:00<00:04, 20.83it/s] 15%|█▍        | 14/95 [00:00<00:03, 20.99it/s] 18%|█▊        | 17/95 [00:00<00:03, 21.09it/s] 21%|██        | 20/95 [00:00<00:03, 21.17it/s] 24%|██▍       | 23/95 [00:01<00:03, 21.23it/s] 27%|██▋       | 26/95 [00:01<00:03, 21.27it/s] 31%|███       | 29/95 [00:01<00:03, 21.30it/s] 34%|███▎      | 32/95 [00:01<00:02, 21.33it/s] 37%|███▋      | 35/95 [00:01<00:02, 21.35it/s] 40%|████      | 38/95 [00:01<00:02, 21.37it/s] 43%|████▎     | 41/95 [00:01<00:02, 21.38it/s] 46%|████▋     | 44/95 [00:02<00:02, 21.40it/s] 49%|████▉     | 47/95 [00:02<00:02, 21.41it/s] 53%|█████▎    | 50/95 [00:02<00:02, 21.42it/s] 56%|█████▌    | 53/95 [00:02<00:01, 21.43it/s] 59%|█████▉    | 56/95 [00:02<00:01, 21.44it/s] 62%|██████▏   | 59/95 [00:02<00:01, 21.45it/s] 65%|██████▌   | 62/95 [00:02<00:01, 21.45it/s] 68%|██████▊   | 65/95 [00:03<00:01, 21.46it/s] 72%|███████▏  | 68/95 [00:03<00:01, 21.47it/s] 75%|███████▍  | 71/95 [00:03<00:01, 21.47it/s] 78%|███████▊  | 74/95 [00:03<00:00, 21.48it/s] 81%|████████  | 77/95 [00:03<00:00, 21.48it/s] 84%|████████▍ | 80/95 [00:03<00:00, 21.49it/s] 87%|████████▋ | 83/95 [00:03<00:00, 21.49it/s] 91%|█████████ | 86/95 [00:04<00:00, 21.49it/s] 94%|█████████▎| 89/95 [00:04<00:00, 21.50it/s] 97%|█████████▋| 92/95 [00:04<00:00, 21.50it/s]100%|██████████| 95/95 [00:04<00:00, 21.52it/s]

:::MLPv0.5.0 ncf 1560195998.733885527 (ncf.py:440) eval_start

:::MLPv0.5.0 ncf 1560196001.155563354 (ncf.py:152) eval_size: {"epoch": 12, "value": 138493000}

:::MLPv0.5.0 ncf 1560196001.155957699 (ncf.py:153) eval_hp_num_users: 138493

:::MLPv0.5.0 ncf 1560196001.156304598 (ncf.py:154) eval_hp_num_neg: 999
Epoch 12: HR@10 = 0.6351, NDCG@10 = 0.3793, train_time = 4.64, val_time = 2.42

:::MLPv0.5.0 ncf 1560196001.156864405 (ncf.py:452) eval_accuracy: {"epoch": 12, "value": 0.6351079115911995}

:::MLPv0.5.0 ncf 1560196001.157191515 (ncf.py:453) eval_target: 0.635

:::MLPv0.5.0 ncf 1560196001.157499552 (ncf.py:454) eval_stop
Hit threshold of 0.635

:::MLPv0.5.0 ncf 1560196001.157835960 (ncf.py:462) run_stop: {"success": true}

:::MLPv0.5.0 ncf 1560196001.158128738 (ncf.py:464) run_final
mlperf_score 100.68413758277893
+ ret_code=0
+ set +x
ENDING TIMING RUN AT 2019-06-10 07:46:44 PM
RESULT,RECOMMENDATION,     6922852,106,nvidia,2019-06-10 07:44:58 PM
